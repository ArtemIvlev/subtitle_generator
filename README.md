# Генератор субтитров из видео

Этот проект позволяет автоматически генерировать субтитры из видео файлов с помощью модели Whisper. Проект использует библиотеку `faster-whisper`, которая является оптимизированной версией Whisper и работает быстрее оригинальной реализации.

## Возможности

- Извлечение аудио из видео файлов
- Генерация субтитров в формате SRT
- Поддержка различных размеров модели Whisper
- Прогресс-бары для отслеживания процесса
- Автоматическое удаление временных файлов
- Поддержка GPU (CUDA) для ускорения обработки
- Многопоточная обработка на CPU
- Фильтр VAD для удаления тишины
- Поддержка различных языков
- Пропуск существующих файлов для оптимизации
- Перевод готовых субтитров на другие языки

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/ArtemIvlev/subtitle_generator.git
cd subtitle_generator
```

2. Создайте виртуальное окружение и активируйте его:
```bash
python -m venv venv
source venv/bin/activate  # для Linux/Mac
# или
venv\Scripts\activate  # для Windows
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Использование

### Генерация субтитров

Базовое использование:
```bash
python subtitle_generator.py путь/к/видео.mp4
```

#### Параметры генерации субтитров

- `video_path` (обязательный): путь к видео файлу
- `--model-size` (опциональный): размер модели Whisper (tiny, base, small, medium, large). По умолчанию: base
- `--language` (опциональный): язык распознавания (например, en, ru, fr). По умолчанию: auto
- `--output-dir` (опциональный): директория для сохранения результатов. По умолчанию: та же директория, где находится видео
- `--device` (опциональный): устройство для обработки (cpu, cuda, auto). По умолчанию: auto
- `--compute-type` (опциональный): тип вычислений (int8, float16, float32, auto). По умолчанию: auto
- `--threads` (опциональный): количество потоков для CPU. По умолчанию: auto
- `--force` (опциональный): принудительное пересоздание существующих файлов

### Перевод субтитров

Базовое использование:
```bash
python subtitle_translator.py путь/к/субтитрам.srt
```

#### Параметры перевода субтитров

- `input_file` (обязательный): путь к файлу субтитров
- `--output`, `-o` (опциональный): путь к выходному файлу. По умолчанию: добавляется суффикс с языком перевода
- `--src-lang` (опциональный): исходный язык (например, en, auto). По умолчанию: auto
- `--dest-lang` (опциональный): язык перевода (например, ru, en). По умолчанию: ru

### Примеры использования

1. Генерация субтитров:
```bash
# Быстрое распознавание с маленькой моделью
python subtitle_generator.py video.mp4 --model-size tiny

# Качественное распознавание с большой моделью
python subtitle_generator.py video.mp4 --model-size large

# Распознавание на определенном языке
python subtitle_generator.py video.mp4 --language en

# Использование GPU
python subtitle_generator.py video.mp4 --device cuda --compute-type float16

# Оптимизация для CPU
python subtitle_generator.py video.mp4 --threads 4 --compute-type int8
```

2. Перевод субтитров:
```bash
# Перевод на русский язык (по умолчанию)
python subtitle_translator.py subtitles.srt

# Перевод на английский язык
python subtitle_translator.py subtitles.srt --dest-lang en

# Перевод с указанием исходного языка
python subtitle_translator.py subtitles.srt --src-lang en --dest-lang ru

# Перевод с указанием выходного файла
python subtitle_translator.py subtitles.srt --output translated_subtitles.srt
```

## Формат вывода

Субтитры сохраняются в формате SRT:
```
1
00:00:00,000 --> 00:00:03,000
Текст субтитра

2
00:00:03,000 --> 00:00:06,000
Следующий текст субтитра
```

## Требования

- Python 3.8 или выше
- Достаточно места на диске для временных файлов
- Достаточно оперативной памяти для работы с выбранной моделью Whisper
- Для использования GPU:
  - NVIDIA GPU с поддержкой CUDA
  - Установленные драйверы NVIDIA
  - Установленный CUDA Toolkit
  - Установленный cuDNN
- Доступ в интернет для перевода субтитров

## Поддерживаемые форматы видео

- MP4
- AVI
- MKV
- MOV
- WMV
- FLV
- и другие форматы, поддерживаемые FFmpeg

## Лицензия

MIT
